#!/usr/bin/env bash

build_dir=${1:-}
env_dir=${3:-}
GITHUB_PACKAGES_TOKEN="$(cat $env_dir/GITHUB_PACKAGES_TOKEN)"

if [ "GITHUB_PACKAGES_TOKEN" != "" ]; then
	echo "-----> Creating .npmrc from env GITHUB_PACKAGES_TOKEN"

	echo "engine-strict=true
  @devforce:registry=https://npm.pkg.github.com
  //npm.pkg.github.com/:_authToken=${GITHUB_PACKAGES_TOKEN}
  always-auth=true" > "$build_dir/.npmrc"

  wc -l $build_dir/.npmrc
	exit 0
else
  echo "GITHUB_PACKAGES_TOKEN not set!"
fi